/*
 * Copyright (c) Adrien Foulon - 2018. All rights reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

(function($){"use strict";$.redux_welcome=$.redux_welcome||{};$(document).ready(function(){$.redux_welcome.initQtip();if(jQuery(document.getElementById("support_div")).is(":visible")){$.redux_welcome.initSupportPage()}$.redux_welcome.supportHash()});$.redux_welcome.supportHash=function(){jQuery("#support_hash").focus(function(){var $this=jQuery(this);$this.select();$this.mouseup(function(){$this.unbind("mouseup");return false})});jQuery(".redux_support_hash").click(function(e){var $button=jQuery(this);if($button.hasClass("disabled")){return}var $nonce=jQuery("#redux_support_nonce").val();$button.addClass("disabled");$button.parent().append('<span class="spinner" style="display:block;float: none;margin: 10px auto;"></span>');$button.closest(".spinner").fadeIn();if(!window.console)console={};console.log=console.log||function(name,data){};jQuery.ajax({type:"post",dataType:"json",url:ajaxurl,data:{action:"redux_support_hash",nonce:$nonce},error:function(response){console.log(response);$button.removeClass("disabled");$button.parent().find(".spinner").remove();alert("There was an error. Please try again later.")},success:function(response){if(response.status=="success"){jQuery("#support_hash").val("http://support.redux.io/?id="+response.identifier);$button.parents("fieldset:first").find(".next").removeAttr("disabled").click()}else{console.log(response);alert("There was an error. Please try again later.")}}});e.preventDefault()})};$.redux_welcome.initSupportPage=function(){var current_fs,next_fs,previous_fs;var left,opacity,scale;var animating;$.fn.actualHeight=function(){var visibleParent=this.closest(":visible").children(),thisHeight;visibleParent.addClass("temp-show");thisHeight=this.height();visibleParent.removeClass("temp-show");return thisHeight};function setHeight(){var $height=0;jQuery(document).find("#support_div fieldset").each(function(){var $actual=$(this).actualHeight();if($height<$actual){$height=$actual}});jQuery("#support_div").height($height+20)}setHeight();$(window).on("resize",function(){setHeight()});jQuery("#is_user").click(function(){jQuery("#final_support .is_user").show();jQuery("#final_support .is_developer").hide();jQuery(this).parents("fieldset:first").find(".next").click()});jQuery("#is_developer").click(function(){jQuery("#final_support .is_user").hide();jQuery("#final_support .is_developer").show();jQuery(this).parents("fieldset:first").find(".next").click()});jQuery("#support_div .next").click(function(){if(animating)return false;animating=true;current_fs=jQuery(this).parent();next_fs=jQuery(this).parent().next();jQuery("#progressbar li").eq(jQuery("fieldset").index(next_fs)).addClass("active");next_fs.show();current_fs.animate({opacity:0},{step:function(now,mx){scale=1-(1-now)*.2;left=now*50+"%";opacity=1-now;current_fs.css({transform:"scale("+scale+")"});next_fs.css({left:left,opacity:opacity})},duration:800,complete:function(){current_fs.hide();animating=false},easing:"easeInOutBack"})});jQuery("#support_div .previous").click(function(){if(animating)return false;animating=true;current_fs=jQuery(this).parent();previous_fs=jQuery(this).parent().prev();jQuery("#progressbar li").eq(jQuery("fieldset").index(current_fs)).removeClass("active");previous_fs.show();current_fs.animate({opacity:0},{step:function(now,mx){scale=.8+(1-now)*.2;left=(1-now)*50+"%";opacity=1-now;current_fs.css({left:left});previous_fs.css({transform:"scale("+scale+")",opacity:opacity})},duration:800,complete:function(){current_fs.hide();animating=false},easing:"easeInOutBack"})})};$.redux_welcome.initQtip=function(){if($().qtip){var shadow="qtip-shadow";var color="qtip-dark";var rounded="";var style="";var classes=shadow+","+color+","+rounded+","+style;classes=classes.replace(/,/g," ");var myPos="top center";var atPos="bottom center";var showEvent="click";var hideEvent="click mouseleave";var tipShowEffect="slide";var tipShowDuration="500";var tipHideEffect="slide";var tipHideDuration="500";$(".redux-hint-qtip").each(function(){$(this).qtip({content:{text:$(this).attr("qtip-content"),title:$(this).attr("qtip-title")},show:{effect:function(){switch(tipShowEffect){case"slide":$(this).slideDown(tipShowDuration);break;case"fade":$(this).fadeIn(tipShowDuration);break;default:$(this).show();break}},event:showEvent},hide:{effect:function(){switch(tipHideEffect){case"slide":$(this).slideUp(tipHideDuration);break;case"fade":$(this).fadeOut(tipHideDuration);break;default:$(this).show(tipHideDuration);break}},event:hideEvent},style:{classes:classes},position:{my:myPos,at:atPos}})})}}})(jQuery);